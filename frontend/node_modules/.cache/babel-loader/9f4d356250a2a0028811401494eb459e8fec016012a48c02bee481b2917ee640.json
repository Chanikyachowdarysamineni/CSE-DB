{"ast":null,"code":"var _jsxFileName = \"D:\\\\documents\\\\Desktop\\\\CSE-DB\\\\frontend\\\\src\\\\contexts\\\\NotificationContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport { UserContext } from '../App';\nimport { setupBroadcastListener } from '../utils/notificationBroadcast';\nimport { useSocket } from './SocketContext';\nimport fetchWithAuth from '../utils/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const NotificationContext = /*#__PURE__*/createContext();\nexport const NotificationProvider = ({\n  children\n}) => {\n  _s();\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const user = useContext(UserContext);\n  const {\n    on,\n    off,\n    connected\n  } = useSocket();\n\n  // Fetch notifications from database\n  const fetchNotifications = React.useCallback(async () => {\n    if (!(user !== null && user !== void 0 && user.id)) return;\n    try {\n      const res = await fetchWithAuth('/api/notifications');\n      if (res.ok) {\n        const data = await res.json();\n        setNotifications(data);\n        setUnreadCount(data.filter(n => !n.read).length);\n      }\n    } catch (err) {\n      console.warn('Failed to fetch notifications:', err);\n    }\n  }, [user === null || user === void 0 ? void 0 : user.id]);\n\n  // Load notifications on mount\n  useEffect(() => {\n    fetchNotifications();\n  }, [fetchNotifications]);\n\n  // Add notification function - wrapped in useCallback to prevent dependency issues\n  const addNotification = React.useCallback(notification => {\n    const newNotif = {\n      id: Date.now() + Math.random(),\n      ...notification,\n      read: false,\n      timestamp: new Date().toISOString(),\n      channel: 'In-app'\n    };\n    setNotifications(prev => {\n      // Check for duplicates\n      const isDuplicate = prev.some(n => n.title === newNotif.title && n.message === newNotif.message && new Date(n.timestamp).getTime() > Date.now() - 60000 // Within last minute\n      );\n      if (isDuplicate) return prev;\n      return [newNotif, ...prev].slice(0, 100); // Keep only last 100\n    });\n    setUnreadCount(prev => prev + 1);\n\n    // Show browser notification if permitted\n    if ('Notification' in window && Notification.permission === 'granted') {\n      new Notification(newNotif.title, {\n        body: newNotif.message,\n        icon: '/logo.png',\n        badge: '/logo.png'\n      });\n    }\n  }, []);\n\n  // Real-time notification listeners\n  useEffect(() => {\n    if (!connected || !(user !== null && user !== void 0 && user.id)) return;\n    const handleNewNotification = notification => {\n      const newNotif = {\n        ...notification,\n        id: notification._id || notification.id,\n        timestamp: notification.created_at || notification.timestamp\n      };\n      setNotifications(prev => {\n        // Check for duplicates by ID or by title+message+timestamp\n        const isDuplicate = prev.some(n => {\n          const sameId = n.id === newNotif.id || n._id === newNotif._id;\n          const sameContent = n.title === newNotif.title && n.message === newNotif.message && Math.abs(new Date(n.timestamp).getTime() - new Date(newNotif.timestamp).getTime()) < 5000;\n          return sameId || sameContent;\n        });\n        if (isDuplicate) {\n          console.log('Duplicate notification prevented:', newNotif.title);\n          return prev;\n        }\n        return [newNotif, ...prev].slice(0, 100);\n      });\n\n      // Only increment if not duplicate\n      if (!newNotif.read) {\n        setUnreadCount(prev => prev + 1);\n      }\n\n      // Show browser notification\n      if ('Notification' in window && Notification.permission === 'granted') {\n        new Notification(newNotif.title, {\n          body: newNotif.message,\n          icon: '/logo.png',\n          badge: '/logo.png'\n        });\n      }\n    };\n\n    // Listen for various content updates\n    const handleNewAnnouncement = announcement => {\n      if (user.role === 'Student' && announcement.status === 'approved') {\n        handleNewNotification({\n          id: `announcement-${announcement._id || announcement.id}-${Date.now()}`,\n          title: 'ðŸ“¢ New Announcement',\n          message: announcement.title,\n          type: 'announcement',\n          link: '/announcements',\n          read: false\n        });\n      }\n    };\n    const handleNewEvent = event => {\n      if (user.role === 'Student') {\n        handleNewNotification({\n          id: `event-${event._id || event.id}-${Date.now()}`,\n          title: 'ðŸ“… New Event',\n          message: event.title,\n          type: 'event',\n          link: '/events',\n          read: false\n        });\n      }\n    };\n    const handleNewAssignment = assignment => {\n      if (user.role === 'Student' && assignment.status === 'approved') {\n        handleNewNotification({\n          id: `assignment-${assignment._id || assignment.id}-${Date.now()}`,\n          title: 'ðŸ“š New Assignment',\n          message: `${assignment.title} - Due: ${new Date(assignment.deadline).toLocaleDateString()}`,\n          type: 'assignment',\n          link: '/academics',\n          priority: 'high',\n          read: false\n        });\n      }\n    };\n    const handleNewProject = project => {\n      if (user.role === 'Student') {\n        handleNewNotification({\n          id: `project-${project._id || project.id}-${Date.now()}`,\n          title: 'ðŸ’¼ New Project',\n          message: project.title,\n          type: 'project',\n          link: '/projects',\n          read: false\n        });\n      }\n    };\n    on('notification:new', handleNewNotification);\n    on('announcement:new', handleNewAnnouncement);\n    on('announcement:updated', handleNewAnnouncement);\n    on('event:new', handleNewEvent);\n    on('assignment:new', handleNewAssignment);\n    on('project:new', handleNewProject);\n    return () => {\n      off('notification:new', handleNewNotification);\n      off('announcement:new', handleNewAnnouncement);\n      off('announcement:updated', handleNewAnnouncement);\n      off('event:new', handleNewEvent);\n      off('assignment:new', handleNewAssignment);\n      off('project:new', handleNewProject);\n    };\n  }, [connected, user, on, off]);\n  const getItemLink = (type, id) => {\n    const linkMap = {\n      'Announcement': '/announcements',\n      'Assignment': '/academics',\n      'Project': '/projects',\n      'Event': '/events',\n      'Form': '/forms',\n      'Resource': '/resources'\n    };\n    return linkMap[type] || '/';\n  };\n  const markAsRead = React.useCallback(async id => {\n    try {\n      await fetchWithAuth(`/api/notifications/${id}/read`, {\n        method: 'PUT'\n      });\n      setNotifications(prev => prev.map(n => n.id === id || n._id === id ? {\n        ...n,\n        read: true\n      } : n));\n      setUnreadCount(prev => Math.max(0, prev - 1));\n    } catch (err) {\n      console.warn('Failed to mark as read:', err);\n    }\n  }, []);\n  const markAllAsRead = React.useCallback(async () => {\n    try {\n      await fetchWithAuth('/api/notifications/read-all', {\n        method: 'PUT'\n      });\n      setNotifications(prev => prev.map(n => ({\n        ...n,\n        read: true\n      })));\n      setUnreadCount(0);\n    } catch (err) {\n      console.warn('Failed to mark all as read:', err);\n    }\n  }, []);\n  const deleteNotification = React.useCallback(async id => {\n    try {\n      await fetchWithAuth(`/api/notifications/${id}`, {\n        method: 'DELETE'\n      });\n      setNotifications(prev => {\n        const notif = prev.find(n => n.id === id || n._id === id);\n        if (notif && !notif.read) {\n          setUnreadCount(prevCount => Math.max(0, prevCount - 1));\n        }\n        return prev.filter(n => n.id !== id && n._id !== id);\n      });\n    } catch (err) {\n      console.warn('Failed to delete notification:', err);\n    }\n  }, []);\n  const clearAll = React.useCallback(async () => {\n    try {\n      await fetchWithAuth('/api/notifications/clear-all', {\n        method: 'DELETE'\n      });\n      setNotifications([]);\n      setUnreadCount(0);\n    } catch (err) {\n      console.warn('Failed to clear all notifications:', err);\n    }\n  }, []);\n\n  // Request notification permission on mount\n  useEffect(() => {\n    if ('Notification' in window && Notification.permission === 'default') {\n      Notification.requestPermission();\n    }\n  }, []);\n\n  // Listen for broadcast notifications from content creation\n  useEffect(() => {\n    if ((user === null || user === void 0 ? void 0 : user.role) === 'Student') {\n      const cleanup = setupBroadcastListener(addNotification);\n      return cleanup;\n    }\n  }, [user === null || user === void 0 ? void 0 : user.role, addNotification]);\n  const value = React.useMemo(() => ({\n    notifications,\n    unreadCount,\n    addNotification,\n    markAsRead,\n    markAllAsRead,\n    deleteNotification,\n    clearAll\n  }), [notifications, unreadCount, addNotification, markAsRead, markAllAsRead, deleteNotification, clearAll]);\n  return /*#__PURE__*/_jsxDEV(NotificationContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 283,\n    columnNumber: 5\n  }, this);\n};\n_s(NotificationProvider, \"fximUEt69O1mS88j+HWRKBf2JDw=\", false, function () {\n  return [useSocket];\n});\n_c = NotificationProvider;\nexport const useNotifications = () => {\n  _s2();\n  const context = useContext(NotificationContext);\n  if (!context) {\n    throw new Error('useNotifications must be used within NotificationProvider');\n  }\n  return context;\n};\n_s2(useNotifications, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"NotificationProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","UserContext","setupBroadcastListener","useSocket","fetchWithAuth","jsxDEV","_jsxDEV","NotificationContext","NotificationProvider","children","_s","notifications","setNotifications","unreadCount","setUnreadCount","user","on","off","connected","fetchNotifications","useCallback","id","res","ok","data","json","filter","n","read","length","err","console","warn","addNotification","notification","newNotif","Date","now","Math","random","timestamp","toISOString","channel","prev","isDuplicate","some","title","message","getTime","slice","window","Notification","permission","body","icon","badge","handleNewNotification","_id","created_at","sameId","sameContent","abs","log","handleNewAnnouncement","announcement","role","status","type","link","handleNewEvent","event","handleNewAssignment","assignment","deadline","toLocaleDateString","priority","handleNewProject","project","getItemLink","linkMap","markAsRead","method","map","max","markAllAsRead","deleteNotification","notif","find","prevCount","clearAll","requestPermission","cleanup","value","useMemo","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useNotifications","_s2","context","Error","$RefreshReg$"],"sources":["D:/documents/Desktop/CSE-DB/frontend/src/contexts/NotificationContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\r\nimport { UserContext } from '../App';\r\nimport { setupBroadcastListener } from '../utils/notificationBroadcast';\r\nimport { useSocket } from './SocketContext';\r\nimport fetchWithAuth from '../utils/api';\r\n\r\nexport const NotificationContext = createContext();\r\n\r\nexport const NotificationProvider = ({ children }) => {\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const user = useContext(UserContext);\r\n  const { on, off, connected } = useSocket();\r\n\r\n  // Fetch notifications from database\r\n  const fetchNotifications = React.useCallback(async () => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      const res = await fetchWithAuth('/api/notifications');\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        setNotifications(data);\r\n        setUnreadCount(data.filter(n => !n.read).length);\r\n      }\r\n    } catch (err) {\r\n      console.warn('Failed to fetch notifications:', err);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  // Load notifications on mount\r\n  useEffect(() => {\r\n    fetchNotifications();\r\n  }, [fetchNotifications]);\r\n\r\n  // Add notification function - wrapped in useCallback to prevent dependency issues\r\n  const addNotification = React.useCallback((notification) => {\r\n    const newNotif = {\r\n      id: Date.now() + Math.random(),\r\n      ...notification,\r\n      read: false,\r\n      timestamp: new Date().toISOString(),\r\n      channel: 'In-app'\r\n    };\r\n\r\n    setNotifications(prev => {\r\n      // Check for duplicates\r\n      const isDuplicate = prev.some(n => \r\n        n.title === newNotif.title && \r\n        n.message === newNotif.message &&\r\n        new Date(n.timestamp).getTime() > Date.now() - 60000 // Within last minute\r\n      );\r\n      \r\n      if (isDuplicate) return prev;\r\n      \r\n      return [newNotif, ...prev].slice(0, 100); // Keep only last 100\r\n    });\r\n    \r\n    setUnreadCount(prev => prev + 1);\r\n\r\n    // Show browser notification if permitted\r\n    if ('Notification' in window && Notification.permission === 'granted') {\r\n      new Notification(newNotif.title, {\r\n        body: newNotif.message,\r\n        icon: '/logo.png',\r\n        badge: '/logo.png'\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  // Real-time notification listeners\r\n  useEffect(() => {\r\n    if (!connected || !user?.id) return;\r\n\r\n    const handleNewNotification = (notification) => {\r\n      const newNotif = {\r\n        ...notification,\r\n        id: notification._id || notification.id,\r\n        timestamp: notification.created_at || notification.timestamp\r\n      };\r\n\r\n      setNotifications(prev => {\r\n        // Check for duplicates by ID or by title+message+timestamp\r\n        const isDuplicate = prev.some(n => {\r\n          const sameId = (n.id === newNotif.id || n._id === newNotif._id);\r\n          const sameContent = n.title === newNotif.title && \r\n                             n.message === newNotif.message &&\r\n                             Math.abs(new Date(n.timestamp).getTime() - new Date(newNotif.timestamp).getTime()) < 5000;\r\n          return sameId || sameContent;\r\n        });\r\n\r\n        if (isDuplicate) {\r\n          console.log('Duplicate notification prevented:', newNotif.title);\r\n          return prev;\r\n        }\r\n\r\n        return [newNotif, ...prev].slice(0, 100);\r\n      });\r\n\r\n      // Only increment if not duplicate\r\n      if (!newNotif.read) {\r\n        setUnreadCount(prev => prev + 1);\r\n      }\r\n\r\n      // Show browser notification\r\n      if ('Notification' in window && Notification.permission === 'granted') {\r\n        new Notification(newNotif.title, {\r\n          body: newNotif.message,\r\n          icon: '/logo.png',\r\n          badge: '/logo.png'\r\n        });\r\n      }\r\n    };\r\n\r\n    // Listen for various content updates\r\n    const handleNewAnnouncement = (announcement) => {\r\n      if (user.role === 'Student' && announcement.status === 'approved') {\r\n        handleNewNotification({\r\n          id: `announcement-${announcement._id || announcement.id}-${Date.now()}`,\r\n          title: 'ðŸ“¢ New Announcement',\r\n          message: announcement.title,\r\n          type: 'announcement',\r\n          link: '/announcements',\r\n          read: false\r\n        });\r\n      }\r\n    };\r\n\r\n    const handleNewEvent = (event) => {\r\n      if (user.role === 'Student') {\r\n        handleNewNotification({\r\n          id: `event-${event._id || event.id}-${Date.now()}`,\r\n          title: 'ðŸ“… New Event',\r\n          message: event.title,\r\n          type: 'event',\r\n          link: '/events',\r\n          read: false\r\n        });\r\n      }\r\n    };\r\n\r\n    const handleNewAssignment = (assignment) => {\r\n      if (user.role === 'Student' && assignment.status === 'approved') {\r\n        handleNewNotification({\r\n          id: `assignment-${assignment._id || assignment.id}-${Date.now()}`,\r\n          title: 'ðŸ“š New Assignment',\r\n          message: `${assignment.title} - Due: ${new Date(assignment.deadline).toLocaleDateString()}`,\r\n          type: 'assignment',\r\n          link: '/academics',\r\n          priority: 'high',\r\n          read: false\r\n        });\r\n      }\r\n    };\r\n\r\n    const handleNewProject = (project) => {\r\n      if (user.role === 'Student') {\r\n        handleNewNotification({\r\n          id: `project-${project._id || project.id}-${Date.now()}`,\r\n          title: 'ðŸ’¼ New Project',\r\n          message: project.title,\r\n          type: 'project',\r\n          link: '/projects',\r\n          read: false\r\n        });\r\n      }\r\n    };\r\n\r\n    on('notification:new', handleNewNotification);\r\n    on('announcement:new', handleNewAnnouncement);\r\n    on('announcement:updated', handleNewAnnouncement);\r\n    on('event:new', handleNewEvent);\r\n    on('assignment:new', handleNewAssignment);\r\n    on('project:new', handleNewProject);\r\n\r\n    return () => {\r\n      off('notification:new', handleNewNotification);\r\n      off('announcement:new', handleNewAnnouncement);\r\n      off('announcement:updated', handleNewAnnouncement);\r\n      off('event:new', handleNewEvent);\r\n      off('assignment:new', handleNewAssignment);\r\n      off('project:new', handleNewProject);\r\n    };\r\n  }, [connected, user, on, off]);\r\n\r\n  const getItemLink = (type, id) => {\r\n    const linkMap = {\r\n      'Announcement': '/announcements',\r\n      'Assignment': '/academics',\r\n      'Project': '/projects',\r\n      'Event': '/events',\r\n      'Form': '/forms',\r\n      'Resource': '/resources'\r\n    };\r\n    return linkMap[type] || '/';\r\n  };\r\n\r\n  const markAsRead = React.useCallback(async (id) => {\r\n    try {\r\n      await fetchWithAuth(`/api/notifications/${id}/read`, {\r\n        method: 'PUT'\r\n      });\r\n      \r\n      setNotifications(prev => \r\n        prev.map(n => n.id === id || n._id === id ? { ...n, read: true } : n)\r\n      );\r\n      setUnreadCount(prev => Math.max(0, prev - 1));\r\n    } catch (err) {\r\n      console.warn('Failed to mark as read:', err);\r\n    }\r\n  }, []);\r\n\r\n  const markAllAsRead = React.useCallback(async () => {\r\n    try {\r\n      await fetchWithAuth('/api/notifications/read-all', {\r\n        method: 'PUT'\r\n      });\r\n      \r\n      setNotifications(prev => prev.map(n => ({ ...n, read: true })));\r\n      setUnreadCount(0);\r\n    } catch (err) {\r\n      console.warn('Failed to mark all as read:', err);\r\n    }\r\n  }, []);\r\n\r\n  const deleteNotification = React.useCallback(async (id) => {\r\n    try {\r\n      await fetchWithAuth(`/api/notifications/${id}`, {\r\n        method: 'DELETE'\r\n      });\r\n      \r\n      setNotifications(prev => {\r\n        const notif = prev.find(n => (n.id === id || n._id === id));\r\n        if (notif && !notif.read) {\r\n          setUnreadCount(prevCount => Math.max(0, prevCount - 1));\r\n        }\r\n        return prev.filter(n => n.id !== id && n._id !== id);\r\n      });\r\n    } catch (err) {\r\n      console.warn('Failed to delete notification:', err);\r\n    }\r\n  }, []);\r\n\r\n  const clearAll = React.useCallback(async () => {\r\n    try {\r\n      await fetchWithAuth('/api/notifications/clear-all', {\r\n        method: 'DELETE'\r\n      });\r\n      \r\n      setNotifications([]);\r\n      setUnreadCount(0);\r\n    } catch (err) {\r\n      console.warn('Failed to clear all notifications:', err);\r\n    }\r\n  }, []);\r\n\r\n  // Request notification permission on mount\r\n  useEffect(() => {\r\n    if ('Notification' in window && Notification.permission === 'default') {\r\n      Notification.requestPermission();\r\n    }\r\n  }, []);\r\n\r\n  // Listen for broadcast notifications from content creation\r\n  useEffect(() => {\r\n    if (user?.role === 'Student') {\r\n      const cleanup = setupBroadcastListener(addNotification);\r\n      return cleanup;\r\n    }\r\n  }, [user?.role, addNotification]);\r\n\r\n  const value = React.useMemo(() => ({\r\n    notifications,\r\n    unreadCount,\r\n    addNotification,\r\n    markAsRead,\r\n    markAllAsRead,\r\n    deleteNotification,\r\n    clearAll\r\n  }), [notifications, unreadCount, addNotification, markAsRead, markAllAsRead, deleteNotification, clearAll]);\r\n\r\n  return (\r\n    <NotificationContext.Provider value={value}>\r\n      {children}\r\n    </NotificationContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useNotifications = () => {\r\n  const context = useContext(NotificationContext);\r\n  if (!context) {\r\n    throw new Error('useNotifications must be used within NotificationProvider');\r\n  }\r\n  return context;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}